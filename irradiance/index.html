<!DOCTYPE HTML>

<html>

<head>

<title>Solar Irradiance</title>

<style>

</style>

<script src="units.js" type="text/Javascript"></script>
<script type="text/Javascript">
"use strict";

var disp;

var p = POWER[Object.keys(POWER)[0]];
var a = AREA[Object.keys(AREA)[0]];

function dispNum(n){
    var str = n.toExponential();
    var e = str.indexOf("e");
    if (e > 4){
        str = str.slice(0,4) + str.slice(e);
    }
    return str;
}
function recalc(e){
    var unit = e.target.value;
    if (unit in POWER){
        p = POWER[unit];
        powerDisp.innerHTML = dispNum(p);
    } else if (unit in AREA){
        a = AREA[unit];
        areaDisp.innerHTML = dispNum(a);
    }
    var power = IRRADIANCE / p * a;
    disp.innerHTML = dispNum(power);
}

function createOpt(str){
    var opt = document.createElement("option");
    opt.innerHTML = str;
    opt.value = str;
    return opt;
}

function init(){
    var elems = ["disp", "powerSelect", "areaSelect", "powerDisp", "areaDisp"];
    for (var i = 0; i < elems.length; i ++){
        window[elems[i]] = document.getElementById(elems[i]);
    }
    for (var i in POWER){
        powerSelect.appendChild(createOpt(i));
    }
    for (var i in AREA){
        areaSelect.appendChild(createOpt(i));
    }
    powerSelect.addEventListener("change", recalc);
    areaSelect.addEventListener("change", recalc);
}

window.addEventListener("load", init);

</script>

<body>

<h1>Solar Irradiance</h1>

<p>At a distance of 1 AU from the sun, you get...</p>

<span id="disp">1.36e+3</span>

<select id="powerSelect">
</select>
(<span id="powerDisp">1</span> W.)

<span>Per</span>

<select id="areaSelect">
</select>
(<span id="areaDisp">1</span> sq. m.)

</body>

</html>